// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package layouts

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

func AppLayout(d AppLayoutData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<!doctype html><html lang=\"en\"><head><meta charset=\"UTF-8\"><meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"><title>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var2 string
		templ_7745c5c3_Var2, templ_7745c5c3_Err = templ.JoinStringErrs(d.Title)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 9, Col: 19}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var2))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, " ‚Äî Accounting</title><link rel=\"stylesheet\" href=\"/static/css/app.css\"><script src=\"/static/js/htmx.min.js\"></script><script src=\"/static/js/htmx-ext-sse.js\"></script><script src=\"/static/js/alpine.min.js\" defer></script></head><body class=\"h-screen flex overflow-hidden bg-gray-100\" hx-boost=\"true\" data-active-nav=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var3 string
		templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(d.ActiveNav)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 18, Col: 32}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "\" x-data=\"appLayout()\"><!-- Sidebar --><aside class=\"w-64 bg-slate-900 text-white flex-shrink-0 flex flex-col transition-all duration-200\" x-bind:class=\"sidebarOpen ? 'flex' : 'hidden lg:flex'\"><!-- Brand --><div class=\"h-16 flex items-center px-6 border-b border-slate-700 flex-shrink-0\"><a href=\"/dashboard\" class=\"flex items-center gap-2 text-white hover:text-slate-200\"><span class=\"text-xl\">‚åÇ</span> <span class=\"font-semibold text-sm tracking-wide\">Accounting</span></a></div><!-- Nav --><nav class=\"flex-1 overflow-y-auto py-3 px-2 space-y-0.5\"><!-- Home -->")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var4 = []any{navItemClass(d.ActiveNav, "dashboard")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var4...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<a href=\"/dashboard\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var5 string
		templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var4).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\"><span class=\"text-base\">üè†</span> <span>Dashboard</span></a><!-- Sales section --><div><button class=\"w-full flex items-center justify-between px-3 py-2 text-sm text-slate-400 uppercase tracking-wider font-semibold hover:text-slate-200 transition-colors mt-2\" x-on:click=\"toggleSection('sales')\"><span>Sales</span> <span x-bind:class=\"sections.sales ? 'rotate-180' : ''\" class=\"transition-transform text-xs\">‚ñº</span></button><div x-show=\"sections.sales\" x-collapse>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var6 = []any{navItemClass(d.ActiveNav, "customers")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var6...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "<a href=\"/sales/customers\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var7 string
		templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var6).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\"><span>üë•</span> <span>Customers</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var8 = []any{navItemClass(d.ActiveNav, "orders")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var8...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "<a href=\"/sales/orders\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var9 string
		templ_7745c5c3_Var9, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var8).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var9))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "\"><span>üìã</span> <span>Orders</span></a></div></div><!-- Purchases section --><div><button class=\"w-full flex items-center justify-between px-3 py-2 text-sm text-slate-400 uppercase tracking-wider font-semibold hover:text-slate-200 transition-colors mt-2\" x-on:click=\"toggleSection('purchases')\"><span>Purchases</span> <span x-bind:class=\"sections.purchases ? 'rotate-180' : ''\" class=\"transition-transform text-xs\">‚ñº</span></button><div x-show=\"sections.purchases\" x-collapse>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var10 = []any{navItemClass(d.ActiveNav, "vendors")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var10...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "<a href=\"/purchases/vendors\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var11 string
		templ_7745c5c3_Var11, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var10).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var11))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "\"><span>üè¢</span> <span>Vendors</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var12 = []any{navItemClass(d.ActiveNav, "purchase-orders")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var12...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "<a href=\"/purchases/orders\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var13 string
		templ_7745c5c3_Var13, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var12).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var13))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 13, "\"><span>üì¶</span> <span>Purchase Orders</span></a></div></div><!-- Inventory section --><div><button class=\"w-full flex items-center justify-between px-3 py-2 text-sm text-slate-400 uppercase tracking-wider font-semibold hover:text-slate-200 transition-colors mt-2\" x-on:click=\"toggleSection('inventory')\"><span>Inventory</span> <span x-bind:class=\"sections.inventory ? 'rotate-180' : ''\" class=\"transition-transform text-xs\">‚ñº</span></button><div x-show=\"sections.inventory\" x-collapse>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var14 = []any{navItemClass(d.ActiveNav, "products")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var14...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 14, "<a href=\"/inventory/products\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var15 string
		templ_7745c5c3_Var15, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var14).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var15))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 15, "\"><span>üè∑Ô∏è</span> <span>Products</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var16 = []any{navItemClass(d.ActiveNav, "stock")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var16...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 16, "<a href=\"/inventory/stock\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var17 string
		templ_7745c5c3_Var17, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var16).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var17))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 17, "\"><span>üìä</span> <span>Stock Levels</span></a></div></div><!-- Reports section --><div><button class=\"w-full flex items-center justify-between px-3 py-2 text-sm text-slate-400 uppercase tracking-wider font-semibold hover:text-slate-200 transition-colors mt-2\" x-on:click=\"toggleSection('reports')\"><span>Reports</span> <span x-bind:class=\"sections.reports ? 'rotate-180' : ''\" class=\"transition-transform text-xs\">‚ñº</span></button><div x-show=\"sections.reports\" x-collapse>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var18 = []any{navItemClass(d.ActiveNav, "trial-balance")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var18...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 18, "<a href=\"/reports/trial-balance\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var19 string
		templ_7745c5c3_Var19, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var18).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var19))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 19, "\"><span>‚öñÔ∏è</span> <span>Trial Balance</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var20 = []any{navItemClass(d.ActiveNav, "pl")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var20...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 20, "<a href=\"/reports/pl\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var21 string
		templ_7745c5c3_Var21, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var20).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var21))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 21, "\"><span>üìà</span> <span>P&amp;L Report</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var22 = []any{navItemClass(d.ActiveNav, "balance-sheet")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var22...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 22, "<a href=\"/reports/balance-sheet\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var23 string
		templ_7745c5c3_Var23, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var22).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var23))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 23, "\"><span>üìë</span> <span>Balance Sheet</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var24 = []any{navItemClass(d.ActiveNav, "statement")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var24...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 24, "<a href=\"/reports/statement\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var25 string
		templ_7745c5c3_Var25, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var24).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var25))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 25, "\"><span>üóÇÔ∏è</span> <span>Acct Statement</span></a></div></div><!-- Settings section --><div><button class=\"w-full flex items-center justify-between px-3 py-2 text-sm text-slate-400 uppercase tracking-wider font-semibold hover:text-slate-200 transition-colors mt-2\" x-on:click=\"toggleSection('settings')\"><span>Settings</span> <span x-bind:class=\"sections.settings ? 'rotate-180' : ''\" class=\"transition-transform text-xs\">‚ñº</span></button><div x-show=\"sections.settings\" x-collapse>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var26 = []any{navItemClass(d.ActiveNav, "users")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var26...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 26, "<a href=\"/settings/users\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var27 string
		templ_7745c5c3_Var27, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var26).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var27))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 27, "\"><span>üë§</span> <span>Users</span></a> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var28 = []any{navItemClass(d.ActiveNav, "rules")}
		templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var28...)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 28, "<a href=\"/settings/rules\" class=\"")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var29 string
		templ_7745c5c3_Var29, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var28).String())
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var29))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 29, "\"><span>‚öôÔ∏è</span> <span>Account Rules</span></a></div></div></nav><!-- Sidebar footer: logged in user --><div class=\"border-t border-slate-700 px-4 py-3 flex-shrink-0\"><div class=\"flex items-center gap-2\"><div class=\"w-7 h-7 rounded-full bg-slate-600 flex items-center justify-center text-xs font-bold text-white flex-shrink-0\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var30 string
		templ_7745c5c3_Var30, templ_7745c5c3_Err = templ.JoinStringErrs(userInitial(d.Username))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 156, Col: 32}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var30))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 30, "</div><div class=\"min-w-0\"><div class=\"text-sm font-medium text-white truncate\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var31 string
		templ_7745c5c3_Var31, templ_7745c5c3_Err = templ.JoinStringErrs(d.Username)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 159, Col: 72}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var31))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 31, "</div><div class=\"text-xs text-slate-400 truncate\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var32 string
		templ_7745c5c3_Var32, templ_7745c5c3_Err = templ.JoinStringErrs(d.Role)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 160, Col: 60}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var32))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 32, "</div></div></div></div></aside><!-- Main content area --><div class=\"flex-1 flex flex-col overflow-hidden min-w-0\"><!-- Top header --><header class=\"h-16 bg-white border-b border-gray-200 flex items-center px-4 gap-3 flex-shrink-0\"><!-- Hamburger (mobile + collapse toggle) --><button class=\"text-gray-500 hover:text-gray-700 p-1.5 rounded-lg hover:bg-gray-100 transition-colors\" x-on:click=\"sidebarOpen = !sidebarOpen\" aria-label=\"Toggle sidebar\"><svg class=\"w-5 h-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 6h16M4 12h16M4 18h16\"></path></svg></button><!-- Company + FY badge --><div class=\"flex items-center gap-2 min-w-0\"><span class=\"font-semibold text-slate-800 truncate text-sm\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var33 string
		templ_7745c5c3_Var33, templ_7745c5c3_Err = templ.JoinStringErrs(d.CompanyName)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 181, Col: 81}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var33))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 33, "</span> ")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if d.FYBadge != "" {
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 34, "<span class=\"px-2 py-0.5 bg-slate-100 text-slate-600 text-xs font-medium rounded-full flex-shrink-0\">")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var34 string
			templ_7745c5c3_Var34, templ_7745c5c3_Err = templ.JoinStringErrs(d.FYBadge)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 183, Col: 119}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var34))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 35, "</span>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 36, "</div><!-- Spacer --><div class=\"flex-1\"></div><!-- Ask AI button --><button class=\"flex items-center gap-1.5 px-3 py-1.5 bg-slate-900 text-white text-sm font-medium rounded-lg hover:bg-slate-800 transition-colors\" x-on:click=\"chatOpen = true\"><span>‚ú®</span> <span>Ask AI</span></button><!-- User menu --><div class=\"relative\" x-data=\"{ open: false }\"><button class=\"w-8 h-8 rounded-full bg-slate-200 flex items-center justify-center text-sm font-bold text-slate-700 hover:bg-slate-300 transition-colors\" x-on:click=\"open = !open\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var35 string
		templ_7745c5c3_Var35, templ_7745c5c3_Err = templ.JoinStringErrs(userInitial(d.Username))
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 202, Col: 32}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var35))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 37, "</button><div x-show=\"open\" x-on:click.outside=\"open = false\" x-transition class=\"absolute right-0 top-10 w-48 bg-white rounded-xl shadow-lg border border-gray-100 py-1 z-50\"><div class=\"px-4 py-2 border-b border-gray-100\"><div class=\"text-sm font-medium text-gray-900\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var36 string
		templ_7745c5c3_Var36, templ_7745c5c3_Err = templ.JoinStringErrs(d.Username)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 211, Col: 67}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var36))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 38, "</div><div class=\"text-xs text-gray-500\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		var templ_7745c5c3_Var37 string
		templ_7745c5c3_Var37, templ_7745c5c3_Err = templ.JoinStringErrs(d.Role)
		if templ_7745c5c3_Err != nil {
			return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 212, Col: 51}
		}
		_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var37))
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 39, "</div></div><form method=\"POST\" action=\"/logout\"><button type=\"submit\" class=\"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors\">Sign out</button></form></div></div></header><!-- Flash message -->")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		if d.FlashMsg != "" {
			var templ_7745c5c3_Var38 = []any{flashClass(d.FlashKind)}
			templ_7745c5c3_Err = templ.RenderCSSItems(ctx, templ_7745c5c3_Buffer, templ_7745c5c3_Var38...)
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 40, "<div x-data=\"{ show: true }\" x-show=\"show\" x-init=\"setTimeout(() => show = false, 5000)\" x-transition class=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var39 string
			templ_7745c5c3_Var39, templ_7745c5c3_Err = templ.JoinStringErrs(templ.CSSClasses(templ_7745c5c3_Var38).String())
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 1, Col: 0}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var39))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 41, "\"><span>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var40 string
			templ_7745c5c3_Var40, templ_7745c5c3_Err = templ.JoinStringErrs(d.FlashMsg)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `web/templates/layouts/app_layout.templ`, Line: 231, Col: 24}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var40))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 42, "</span> <button x-on:click=\"show = false\" class=\"ml-auto text-current opacity-60 hover:opacity-100\">‚úï</button></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 43, "<!-- Page content --><main class=\"flex-1 overflow-y-auto p-6\">")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templ_7745c5c3_Var1.Render(ctx, templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 44, "</main></div><!-- Chat slide-over --><div x-show=\"chatOpen\" x-transition:enter=\"transition ease-out duration-200\" x-transition:enter-start=\"translate-x-full\" x-transition:enter-end=\"translate-x-0\" x-transition:leave=\"transition ease-in duration-150\" x-transition:leave-start=\"translate-x-0\" x-transition:leave-end=\"translate-x-full\" class=\"fixed inset-y-0 right-0 w-96 bg-white shadow-2xl border-l border-gray-200 flex flex-col z-40\"><!-- Chat header --><div class=\"h-14 flex items-center px-4 border-b border-gray-200 flex-shrink-0\"><span class=\"font-semibold text-slate-800 text-sm\">‚ú® AI Assistant</span> <button class=\"ml-auto text-gray-400 hover:text-gray-600 p-1.5 rounded-lg hover:bg-gray-100\" x-on:click=\"chatOpen = false\">‚úï</button></div><!-- Chat body --><div class=\"flex-1 overflow-y-auto p-4 space-y-3\" id=\"slide-chat-area\"><div class=\"bg-slate-50 rounded-xl p-3 text-sm text-slate-600\">Hello! Ask me anything about your accounts, orders, or describe a transaction.</div></div><!-- Chat input --><div class=\"border-t border-gray-200 p-3 flex-shrink-0\"><form id=\"slide-chat-form\" class=\"flex gap-2\"><textarea id=\"slide-chat-input\" rows=\"1\" placeholder=\"Ask anything‚Ä¶\" class=\"flex-1 text-sm border border-gray-200 rounded-lg px-3 py-2 resize-none focus:outline-none focus:ring-2 focus:ring-slate-400\"></textarea> <button type=\"submit\" class=\"px-3 py-2 bg-slate-900 text-white text-sm rounded-lg hover:bg-slate-800 transition-colors\">‚Üë</button></form></div></div><!-- Chat backdrop (mobile) --><div x-show=\"chatOpen\" x-on:click=\"chatOpen = false\" class=\"fixed inset-0 bg-black bg-opacity-20 z-30 lg:hidden\"></div><script>\r\n\t\t\t\tfunction appLayout() {\r\n\t\t\t\t\tconst sectionMap = {\r\n\t\t\t\t\t\t'customers': 'sales', 'orders': 'sales',\r\n\t\t\t\t\t\t'vendors': 'purchases', 'purchase-orders': 'purchases',\r\n\t\t\t\t\t\t'products': 'inventory', 'stock': 'inventory',\r\n\t\t\t\t\t\t'trial-balance': 'reports', 'pl': 'reports',\r\n\t\t\t\t\t\t'balance-sheet': 'reports', 'statement': 'reports',\r\n\t\t\t\t\t\t'users': 'settings', 'rules': 'settings',\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconst activeNav = document.body.dataset.activeNav || '';\r\n\t\t\t\t\tconst activeSection = sectionMap[activeNav] || '';\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tsidebarOpen: window.innerWidth >= 1024,\r\n\t\t\t\t\t\tchatOpen: false,\r\n\t\t\t\t\t\tsections: {\r\n\t\t\t\t\t\t\tsales: activeSection === 'sales',\r\n\t\t\t\t\t\t\tpurchases: activeSection === 'purchases',\r\n\t\t\t\t\t\t\tinventory: activeSection === 'inventory',\r\n\t\t\t\t\t\t\treports: activeSection === 'reports',\r\n\t\t\t\t\t\t\tsettings: activeSection === 'settings',\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\ttoggleSection(name) {\r\n\t\t\t\t\t\t\tthis.sections[name] = !this.sections[name];\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Slide-over chat ‚Äî shares conversation history with the chat home page via sessionStorage\r\n\t\t\t\t(function() {\r\n\t\t\t\t\tconst form = document.getElementById('slide-chat-form');\r\n\t\t\t\t\tconst input = document.getElementById('slide-chat-input');\r\n\t\t\t\t\tconst area = document.getElementById('slide-chat-area');\r\n\t\t\t\t\tif (!form) return;\r\n\r\n\t\t\t\t\tconst STORAGE_KEY = 'chat_history';\r\n\t\t\t\t\tconst companyCode = document.body.dataset.companyCode || '';\r\n\r\n\t\t\t\t\tfunction escHTML(s) {\r\n\t\t\t\t\t\treturn String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\"/g,'&quot;');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfunction toolLabel(tool) {\r\n\t\t\t\t\t\tconst labels = {\r\n\t\t\t\t\t\t\t'approve_po':'Approve PO','create_vendor':'Create Vendor',\r\n\t\t\t\t\t\t\t'create_purchase_order':'Create PO','receive_po':'Receive Goods',\r\n\t\t\t\t\t\t\t'record_vendor_invoice':'Record Invoice','pay_vendor':'Pay Vendor',\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\treturn labels[tool] || tool;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfunction makeBubble(msg) {\r\n\t\t\t\t\t\tconst div = document.createElement('div');\r\n\t\t\t\t\t\tif (msg.role === 'user') {\r\n\t\t\t\t\t\t\tdiv.className = 'bg-slate-900 text-white rounded-xl px-3 py-2 text-sm ml-6';\r\n\t\t\t\t\t\t\tdiv.textContent = msg.text || '';\r\n\t\t\t\t\t\t} else if (msg.type === 'action_card') {\r\n\t\t\t\t\t\t\tdiv.className = 'border border-amber-200 bg-amber-50 rounded-xl p-3 text-xs mr-6';\r\n\t\t\t\t\t\t\tdiv.innerHTML = '<div class=\"font-semibold text-amber-800 mb-1\">üîß ' + escHTML(toolLabel(msg.tool)) + '</div>'\r\n\t\t\t\t\t\t\t\t+ '<pre class=\"text-amber-700 overflow-auto max-h-20 mb-2\">' + escHTML(JSON.stringify(msg.args, null, 2)) + '</pre>'\r\n\t\t\t\t\t\t\t\t+ ((!msg.status || msg.status === 'pending')\r\n\t\t\t\t\t\t\t\t\t? '<div class=\"flex gap-1 slide-btn-row\">'\r\n\t\t\t\t\t\t\t\t\t\t+ '<button data-token=\"' + escHTML(msg.token||'') + '\" data-action=\"confirm\" class=\"slide-confirm-btn px-2 py-1 bg-amber-600 text-white rounded text-xs\">‚úì Confirm</button>'\r\n\t\t\t\t\t\t\t\t\t\t+ '<button data-token=\"' + escHTML(msg.token||'') + '\" data-action=\"cancel\" class=\"slide-confirm-btn px-2 py-1 border border-amber-300 text-amber-700 rounded text-xs\">‚úï</button>'\r\n\t\t\t\t\t\t\t\t\t\t+ '</div>'\r\n\t\t\t\t\t\t\t\t\t: '<div class=\"text-slate-500\">' + escHTML(msg.status === 'confirmed' ? ('‚úì ' + (msg.resultText||'Done.')) : 'Cancelled.') + '</div>');\r\n\t\t\t\t\t\t\tdiv.dataset.msgToken = msg.token || '';\r\n\t\t\t\t\t\t} else if (msg.type === 'proposal') {\r\n\t\t\t\t\t\t\tconst p = msg.proposal || {};\r\n\t\t\t\t\t\t\tdiv.className = 'border border-blue-200 bg-blue-50 rounded-xl p-3 text-xs mr-6';\r\n\t\t\t\t\t\t\tdiv.innerHTML = '<div class=\"font-semibold text-blue-800 mb-1\">üßæ Journal Entry</div>'\r\n\t\t\t\t\t\t\t\t+ '<div class=\"text-blue-700 mb-1\">' + escHTML(p.summary||'') + '</div>'\r\n\t\t\t\t\t\t\t\t+ '<div class=\"text-blue-500 mb-2\">Date: ' + escHTML(p.posting_date||'') + '</div>'\r\n\t\t\t\t\t\t\t\t+ ((!msg.status || msg.status === 'pending')\r\n\t\t\t\t\t\t\t\t\t? '<div class=\"flex gap-1 slide-btn-row\">'\r\n\t\t\t\t\t\t\t\t\t\t+ '<button data-token=\"' + escHTML(msg.token||'') + '\" data-action=\"confirm\" class=\"slide-confirm-btn px-2 py-1 bg-blue-600 text-white rounded text-xs\">‚úì Post</button>'\r\n\t\t\t\t\t\t\t\t\t\t+ '<button data-token=\"' + escHTML(msg.token||'') + '\" data-action=\"cancel\" class=\"slide-confirm-btn px-2 py-1 border border-blue-300 text-blue-700 rounded text-xs\">‚úï</button>'\r\n\t\t\t\t\t\t\t\t\t\t+ '</div>'\r\n\t\t\t\t\t\t\t\t\t: '<div class=\"text-slate-500\">' + escHTML(msg.status === 'confirmed' ? '‚úì Posted.' : 'Cancelled.') + '</div>');\r\n\t\t\t\t\t\t\tdiv.dataset.msgToken = msg.token || '';\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tdiv.className = 'bg-slate-50 rounded-xl px-3 py-2 text-sm text-slate-700 mr-6 whitespace-pre-wrap';\r\n\t\t\t\t\t\t\tdiv.textContent = msg.text || '';\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn div;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfunction getHistory() {\r\n\t\t\t\t\t\ttry { return JSON.parse(sessionStorage.getItem(STORAGE_KEY) || '[]'); } catch(e) { return []; }\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfunction saveHistory(msgs) {\r\n\t\t\t\t\t\ttry { sessionStorage.setItem(STORAGE_KEY, JSON.stringify(msgs)); } catch(e) {}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfunction attachConfirmListeners() {\r\n\t\t\t\t\t\tarea.querySelectorAll('.slide-confirm-btn:not([data-bound])').forEach(btn => {\r\n\t\t\t\t\t\t\tbtn.dataset.bound = '1';\r\n\t\t\t\t\t\t\tbtn.addEventListener('click', async function() {\r\n\t\t\t\t\t\t\t\tconst token = btn.dataset.token;\r\n\t\t\t\t\t\t\t\tconst action = btn.dataset.action;\r\n\t\t\t\t\t\t\t\tbtn.disabled = true;\r\n\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\tconst resp = await fetch('/chat/confirm', {\r\n\t\t\t\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\t\t\t\theaders: {'Content-Type': 'application/json'},\r\n\t\t\t\t\t\t\t\t\t\tbody: JSON.stringify({token, action}),\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tconst data = await resp.json();\r\n\t\t\t\t\t\t\t\t\tconst card = area.querySelector('[data-msg-token=\"' + token + '\"]');\r\n\t\t\t\t\t\t\t\t\tconst btnRow = card && card.querySelector('.slide-btn-row');\r\n\t\t\t\t\t\t\t\t\tif (action === 'cancel') {\r\n\t\t\t\t\t\t\t\t\t\tif (btnRow) btnRow.outerHTML = '<div class=\"text-slate-500\">Cancelled.</div>';\r\n\t\t\t\t\t\t\t\t\t} else if (resp.ok && data.ok) {\r\n\t\t\t\t\t\t\t\t\t\tconst txt = (data.result && data.result.message) || 'Done.';\r\n\t\t\t\t\t\t\t\t\t\tif (btnRow) btnRow.outerHTML = '<div class=\"text-green-700 font-medium\">‚úì ' + escHTML(txt) + '</div>';\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (btnRow) btnRow.outerHTML = '<div class=\"text-red-600\">‚ö† ' + escHTML(data.error||'Failed.') + '</div>';\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tconst msgs = getHistory();\r\n\t\t\t\t\t\t\t\t\tconst m = msgs.find(m => m.token === token);\r\n\t\t\t\t\t\t\t\t\tif (m) {\r\n\t\t\t\t\t\t\t\t\t\tm.status = action === 'cancel' ? 'cancelled' : (resp.ok && data.ok ? 'confirmed' : 'error');\r\n\t\t\t\t\t\t\t\t\t\tif (data.result) m.resultText = data.result.message || 'Done.';\r\n\t\t\t\t\t\t\t\t\t\tsaveHistory(msgs);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t} catch(e) { btn.disabled = false; }\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Restore history on slide-over open.\r\n\t\t\t\t\tfunction loadHistory() {\r\n\t\t\t\t\t\tconst msgs = getHistory();\r\n\t\t\t\t\t\tif (msgs.length > 0) {\r\n\t\t\t\t\t\t\t// Clear default greeting\r\n\t\t\t\t\t\t\tconst greeting = area.firstElementChild;\r\n\t\t\t\t\t\t\tif (greeting) greeting.remove();\r\n\t\t\t\t\t\t\tfor (const msg of msgs) area.appendChild(makeBubble(msg));\r\n\t\t\t\t\t\t\tarea.scrollTop = area.scrollHeight;\r\n\t\t\t\t\t\t\tattachConfirmListeners();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Load history when slide-over opens (watch for chatOpen toggle).\r\n\t\t\t\t\tlet historyLoaded = false;\r\n\t\t\t\t\tdocument.addEventListener('alpine:initialized', () => {\r\n\t\t\t\t\t\tdocument.body.__x && document.body.__x.$watch && document.body.__x.$watch('chatOpen', (open) => {\r\n\t\t\t\t\t\t\tif (open && !historyLoaded) { loadHistory(); historyLoaded = true; }\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tform.addEventListener('submit', async function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tconst text = input.value.trim();\r\n\t\t\t\t\t\tif (!text) return;\r\n\r\n\t\t\t\t\t\tconst userMsg = { role: 'user', type: 'text', text };\r\n\t\t\t\t\t\tconst msgs = getHistory();\r\n\t\t\t\t\t\tmsgs.push(userMsg);\r\n\t\t\t\t\t\tsaveHistory(msgs);\r\n\t\t\t\t\t\tif (msgs.length === 1) {\r\n\t\t\t\t\t\t\t// Remove default greeting\r\n\t\t\t\t\t\t\tconst greeting = area.firstElementChild;\r\n\t\t\t\t\t\t\tif (greeting) greeting.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tarea.appendChild(makeBubble(userMsg));\r\n\t\t\t\t\t\tinput.value = '';\r\n\r\n\t\t\t\t\t\tconst thinking = document.createElement('div');\r\n\t\t\t\t\t\tthinking.className = 'bg-slate-50 rounded-xl px-3 py-2 text-sm text-slate-400 mr-6';\r\n\t\t\t\t\t\tthinking.textContent = 'Thinking‚Ä¶';\r\n\t\t\t\t\t\tarea.appendChild(thinking);\r\n\t\t\t\t\t\tarea.scrollTop = area.scrollHeight;\r\n\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst resp = await fetch('/chat', {\r\n\t\t\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t\t\theaders: {'Content-Type': 'application/json'},\r\n\t\t\t\t\t\t\t\tbody: JSON.stringify({text, company_code: companyCode, attachment_ids: []}),\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconst reader = resp.body.getReader();\r\n\t\t\t\t\t\t\tconst decoder = new TextDecoder();\r\n\t\t\t\t\t\t\tlet buf = '', replaced = false;\r\n\t\t\t\t\t\t\tlet aiMsg = null;\r\n\r\n\t\t\t\t\t\t\twhile (true) {\r\n\t\t\t\t\t\t\t\tconst {done, value} = await reader.read();\r\n\t\t\t\t\t\t\t\tif (done) break;\r\n\t\t\t\t\t\t\t\tbuf += decoder.decode(value, {stream: true});\r\n\t\t\t\t\t\t\t\tconst parts = buf.split('\\n\\n');\r\n\t\t\t\t\t\t\t\tbuf = parts.pop() || '';\r\n\t\t\t\t\t\t\t\tfor (const part of parts) {\r\n\t\t\t\t\t\t\t\t\tlet event = 'message', data = '';\r\n\t\t\t\t\t\t\t\t\tfor (const line of part.split('\\n')) {\r\n\t\t\t\t\t\t\t\t\t\tif (line.startsWith('event: ')) event = line.slice(7).trim();\r\n\t\t\t\t\t\t\t\t\t\telse if (line.startsWith('data: ')) data = line.slice(6);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tif (!data) continue;\r\n\t\t\t\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\t\t\t\tconst d = JSON.parse(data);\r\n\t\t\t\t\t\t\t\t\t\tif (!replaced && event !== 'status') { thinking.remove(); replaced = true; }\r\n\t\t\t\t\t\t\t\t\t\tconst currentMsgs = getHistory();\r\n\t\t\t\t\t\t\t\t\t\tif (event === 'answer') {\r\n\t\t\t\t\t\t\t\t\t\t\tif (!aiMsg) {\r\n\t\t\t\t\t\t\t\t\t\t\t\taiMsg = { role: 'ai', type: 'text', text: d.text || '' };\r\n\t\t\t\t\t\t\t\t\t\t\t\tcurrentMsgs.push(aiMsg); saveHistory(currentMsgs);\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst el = makeBubble(aiMsg); el.dataset.aiLive = '1'; area.appendChild(el);\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\taiMsg.text += (d.text || '');\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst live = area.querySelector('[data-ai-live]');\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (live) live.textContent = aiMsg.text;\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst m2 = getHistory();\r\n\t\t\t\t\t\t\t\t\t\t\t\tconst last = m2[m2.length-1];\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (last && last.type === 'text' && last.role === 'ai') { last.text = aiMsg.text; saveHistory(m2); }\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t} else if (event === 'clarification') {\r\n\t\t\t\t\t\t\t\t\t\t\tconst msg = { role: 'ai', type: 'text', text: '‚ùì ' + (d.question||'') };\r\n\t\t\t\t\t\t\t\t\t\t\tcurrentMsgs.push(msg); saveHistory(currentMsgs); area.appendChild(makeBubble(msg));\r\n\t\t\t\t\t\t\t\t\t\t} else if (event === 'action_card') {\r\n\t\t\t\t\t\t\t\t\t\t\tconst msg = { role: 'ai', type: 'action_card', token: d.token, tool: d.tool, args: d.args, status: 'pending' };\r\n\t\t\t\t\t\t\t\t\t\t\tcurrentMsgs.push(msg); saveHistory(currentMsgs);\r\n\t\t\t\t\t\t\t\t\t\t\tarea.appendChild(makeBubble(msg)); attachConfirmListeners();\r\n\t\t\t\t\t\t\t\t\t\t} else if (event === 'proposal') {\r\n\t\t\t\t\t\t\t\t\t\t\tconst msg = { role: 'ai', type: 'proposal', token: d.token, proposal: d.proposal, status: 'pending' };\r\n\t\t\t\t\t\t\t\t\t\t\tcurrentMsgs.push(msg); saveHistory(currentMsgs);\r\n\t\t\t\t\t\t\t\t\t\t\tarea.appendChild(makeBubble(msg)); attachConfirmListeners();\r\n\t\t\t\t\t\t\t\t\t\t} else if (event === 'error') {\r\n\t\t\t\t\t\t\t\t\t\t\tconst msg = { role: 'ai', type: 'text', text: '‚ö† ' + (d.message||'Error') };\r\n\t\t\t\t\t\t\t\t\t\t\tcurrentMsgs.push(msg); saveHistory(currentMsgs); area.appendChild(makeBubble(msg));\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tarea.scrollTop = area.scrollHeight;\r\n\t\t\t\t\t\t\t\t\t} catch(e) {}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (!replaced) { thinking.remove(); }\r\n\t\t\t\t\t\t} catch(err) {\r\n\t\t\t\t\t\t\tthinking.remove();\r\n\t\t\t\t\t\t\tconst msg = { role: 'ai', type: 'text', text: '‚ö† Connection error: ' + err.message };\r\n\t\t\t\t\t\t\tconst msgs2 = getHistory(); msgs2.push(msg); saveHistory(msgs2);\r\n\t\t\t\t\t\t\tarea.appendChild(makeBubble(msg));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tarea.scrollTop = area.scrollHeight;\r\n\t\t\t\t\t});\r\n\t\t\t\t})();\r\n\t\t\t</script></body></html>")
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

// navItemClass returns the CSS classes for a sidebar nav item.
func navItemClass(activeNav, key string) string {
	base := "flex items-center gap-2.5 px-3 py-2 rounded-lg text-sm transition-colors "
	if activeNav == key {
		return base + "bg-slate-700 text-white font-medium"
	}
	return base + "text-slate-300 hover:bg-slate-800 hover:text-white"
}

// userInitial returns the first letter of the username in uppercase.
func userInitial(username string) string {
	if len(username) == 0 {
		return "?"
	}
	r := rune(username[0])
	if r >= 'a' && r <= 'z' {
		r = r - 32
	}
	return string(r)
}

// flashClass returns CSS classes for the flash message bar based on kind.
func flashClass(kind string) string {
	base := "flex items-center gap-2 px-4 py-2.5 text-sm font-medium border-b flex-shrink-0 "
	switch kind {
	case "error":
		return base + "bg-red-50 text-red-700 border-red-200"
	case "warning":
		return base + "bg-yellow-50 text-yellow-700 border-yellow-200"
	case "success":
		return base + "bg-green-50 text-green-700 border-green-200"
	default:
		return base + "bg-blue-50 text-blue-700 border-blue-200"
	}
}

var _ = templruntime.GeneratedTemplate
